var scriptShowMaxLine=1;function showScriptContent(e,a){var t=new Object;t.scriptInfoId=e,t.type=a,$.ajax({url:_ctx+"/script/view",data:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json"},type:"POST",async:!0,success:function(e){"200"==e.code?($("#viewScriptModal_scriptName").text(e.data.script),$("#viewScriptModal_scriptContent").html("<pre>"+e.data.content+"</pre>"),$("#viewScriptModal").modal("show")):alert(e.message)},error:function(e,a,t){ajaxErrorHandler()}})}function getPartialContent(e){var a="";if(null!=e&&""!=e){var t=e.split("<br>");if(t.length>scriptShowMaxLine){for(var r=0;r<scriptShowMaxLine;r++)a+=t[r],r!=scriptShowMaxLine-1&&(a+="<br>");a+='&nbsp;&nbsp;<a href="javascript:void(0);" >...(顯示)</a>'}else a=e}return a}function findData(e){$("#queryFrom").val(e),$("input[name=checkAll]").prop("checked",!1),"MOBILE"==e&&$("#collapseExample").collapse("hide"),"undefined"!=typeof resutTable?(resutTable.clear().draw(),resutTable.ajax.reload()):($(".myTableSection").show(),resutTable=$("#resutTable").DataTable({autoWidth:!0,paging:!0,bFilter:!0,ordering:!0,info:!0,serverSide:!0,bLengthChange:!0,pagingType:"full",processing:!0,scrollX:!0,scrollY:dataTableHeight,scrollCollapse:!0,pageLength:10,language:{url:_ctx+"/resources/js/dataTable/i18n/Chinese-traditional.json"},ajax:{url:_ctx+"/script/getScriptData.json",type:"POST",data:function(e){return"WEB"==$("#queryFrom").val()?e.queryScriptTypeCode=$("#queryScriptType").val():"MOBILE"==$("#queryFrom").val()&&(e.queryScriptTypeCode=$("#queryScriptType_mobile").val()),e},error:function(e,a,t){ajaxErrorHandler()}},order:[[3,"asc"]],drawCallback:function(e){$("div.dataTables_length").parent().removeClass("col-sm-12"),$("div.dataTables_length").parent().addClass("col-sm-6"),$("div.dataTables_filter").parent().removeClass("col-sm-12"),$("div.dataTables_filter").parent().addClass("col-sm-6"),$("div.dataTables_info").parent().removeClass("col-sm-12"),$("div.dataTables_info").parent().addClass("col-sm-6"),$("div.dataTables_paginate").parent().removeClass("col-sm-12"),$("div.dataTables_paginate").parent().addClass("col-sm-6"),bindTrEvent(),initCheckedItems()},createdRow:function(e,a,t){0==a.enableModify&&$(e).children("td").eq(0).addClass("hide"),null!=a.actionScript&&($(e).children("td").eq(5).attr("onclick","javascript:showScriptContent('"+a.scriptInfoId+"', 'A');"),$(e).children("td").eq(5).addClass("cursor_zoom_in")),null!=a.checkScript&&($(e).children("td").eq(7).attr("onclick","javascript:showScriptContent('"+a.scriptInfoId+"', 'C');"),$(e).children("td").eq(7).addClass("cursor_zoom_in"))},columns:[{},{},{data:"scriptName"},{data:"scriptTypeName",className:"left"},{data:"systemVersion",className:"center"},{},{data:"actionScriptRemark"},{},{data:"checkScriptRemark"},{data:"createTimeStr",className:"center"},{data:"updateTimeStr",className:"center"}],columnDefs:[{targets:[0],className:"center",searchable:!1,orderable:!1,render:function(e,a,t){return'<input type="radio" id="chkbox" name="radiobox" onclick="resetTrBgColor();changeTrBgColor(this)" value='+t.scriptTypeId+">"}},{targets:[1],className:"center",searchable:!1,orderable:!1,render:function(e,a,t,r){return r.row+r.settings._iDisplayStart+1}},{targets:[5],className:"left",searchable:!0,orderable:!0,render:function(e,a,t,r){return getPartialContent(t.actionScript)}},{targets:[7],className:"left",searchable:!0,orderable:!0,render:function(e,a,t,r){return getPartialContent(t.checkScript)}}]}))}$(document).ready(function(){initMenuStatus("toggleMenu_cm","toggleMenu_cm_items","cm_script"),findData("WEB")});