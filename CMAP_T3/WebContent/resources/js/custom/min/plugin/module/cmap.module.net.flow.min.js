var timer,startTime,timer_start,timer_end;function countDown(e){if("START"==e)startTime=parseInt(_timeout)-1,timer_start=performance.now(),timer=setInterval(function(){$("#timeoutMsg").val("Timeout倒數 : "+startTime+" 秒"),startTime--},1e3);else{timer_end=performance.now();var a=(parseInt(timer_end)-parseInt(timer_start))/1e3;$("#timeoutMsg").val("查詢花費時間 : "+a+" 秒"),clearInterval(timer)}}function findData(e){$("#queryFrom").val(e),0!=$("#queryGroup").val().trim().length?0!=$("#queryDateBegin").val().trim().length?("MOBILE"==e&&$("#collapseExample").collapse("hide"),"undefined"!=typeof resutTable?(resutTable.ajax.reload(),$(".myTableSection").show()):($(".myTableSection").show(),resutTable=$("#resutTable").DataTable({autoWidth:!0,paging:!0,bFilter:!0,ordering:!0,info:!0,serverSide:!0,bLengthChange:!0,pagingType:"full",processing:!0,scrollX:!0,scrollY:dataTableHeight,scrollCollapse:!0,pageLength:100,language:{url:_ctx+"/resources/js/dataTable/i18n/Chinese-traditional.json"},createdRow:function(e,a,t){},ajax:{url:_ctx+"/plugin/module/netFlow/getNetFlowData.json",type:"POST",data:function(e){return"WEB"==$("#queryFrom").val()?(e.queryGroup=$("#queryGroup").val(),e.querySourceIp=$("#query_SourceIp").val(),e.queryDestinationIp=$("#query_DestinationIp").val(),e.querySenderIp=$("#query_SenderIp").val(),e.querySourcePort=$("#query_SourcePort").val(),e.queryDestinationPort=$("#query_DestinationPort").val(),e.queryDateBegin=$("#queryDateBegin").val(),e.queryTimeBegin=$("#queryTimeBegin").val(),e.queryTimeEnd=$("#queryTimeEnd").val()):"MOBILE"==$("#queryFrom").val()&&(e.queryGroup=$("#queryGroup_mobile").val(),e.querySourceIp=$("#query_SourceIp_mobile").val(),e.queryDestinationIp=$("#query_DestinationIp_mobile").val(),e.querySenderIp=$("#query_SenderIp_mobile").val(),e.querySourcePort=$("#query_SourcePort_mobile").val(),e.queryDestinationPort=$("#query_DestinationPort_mobile").val(),e.queryDateBegin=$("#queryDateBegin_mobile").val(),e.queryTimeBegin=$("#queryTimeBegin").val(),e.queryTimeEnd=$("#queryTimeEnd").val()),e},beforeSend:function(){$("#div_TotalFlow").hide(),countDown("START")},complete:function(){countDown("STOP")},error:function(e,a,t){ajaxErrorHandler()},dataSrc:function(e){return e.data.length>0?null!=e.otherMsg&&""!=e.otherMsg&&($("#div_TotalFlow").css("display","contents"),$("#result_TotalFlow").text("總流量："+e.otherMsg)):($("#div_TotalFlow").css("display","contents"),$("#result_TotalFlow").text("查無符合資料")),e.data},timeout:1e3*parseInt(_timeout)},initComplete:function(e,a){null!=a.msg&&($(".myTableSection").hide(),alert(a.msg))},drawCallback:function(e){$("div.dataTables_length").parent().removeClass("col-sm-12"),$("div.dataTables_length").parent().addClass("col-sm-6"),$("div.dataTables_filter").parent().removeClass("col-sm-12"),$("div.dataTables_filter").parent().addClass("col-sm-6"),$("div.dataTables_info").parent().removeClass("col-sm-12"),$("div.dataTables_info").parent().addClass("col-sm-6"),$("div.dataTables_paginate").parent().removeClass("col-sm-12"),$("div.dataTables_paginate").parent().addClass("col-sm-6"),bindTrEvent()},columns:[{},{data:"groupName"},{data:"now"},{data:"fromDateTime"},{data:"toDateTime"},{data:"ethernetType"},{data:"protocol"},{data:"sourceIP"},{data:"sourcePort"},{data:"sourceMAC"},{data:"destinationIP"},{data:"destinationPort"},{data:"destinationMAC"},{data:"size"},{data:"channelID"},{data:"toS"},{data:"senderIP"},{data:"inboundInterface"},{data:"outboundInterface"},{data:"sourceASI"},{data:"destinationASI"},{data:"sourceMask"},{data:"destinationMask"},{data:"nextHop"},{data:"sourceVLAN"},{data:"destinationVLAN"},{data:"flowID"}],columnDefs:[{targets:[0],className:"center",searchable:!1,orderable:!1,render:function(e,a,t,r){return r.row+r.settings._iDisplayStart+1}}]}))):alert(msg_chooseDate):alert(msg_chooseGroup)}$(document).ready(function(){initMenuStatus("toggleMenu_plugin","toggleMenu_plugin_items","cm_netflow"),$("input").val("");new Cleave(".input-port",{numericOnly:!0,blocks:[5]});$("#resutTable").on("xhr.dt",function(e,a,t,r){null!=t.msg&&($(".myTableSection").hide(),alert(t.msg))});var e=new Date,a=e.getFullYear(),t=parseInt(e.getMonth())+1;t=t<10?"0".concat(t):t;var r=e.getDate();r=r<10?"0".concat(r):r,$("#queryDateBegin").val(a+"-"+t+"-"+r)});